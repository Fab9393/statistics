<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lebesgue vs Riemann Integration Simulation</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&family=Montserrat:wght@600&display=swap" rel="stylesheet">
    <style>
        nav {
            background-color: #333;
            padding: 10px 20px;
        }

        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            text-align: center;
        }

        nav ul li {
            display: inline;
            margin: 0 15px;
        }

        nav a {
            display: inline-block;
            color: white;
            background-color: #007bff;
            padding: 10px 15px;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s;
            font-size: 1.2em;
        }

        nav a:hover {
            background-color: #0056b3;
        }

        /* General Body and Container Styling */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f7f7f7;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column; /* Added to arrange elements vertically */
        }

        /* Main Content Container */
        .container {
            width: 80%;
            max-width: 1000px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
            text-align: center;
            margin-top: 30px;
        }

        /* Title */
        h1 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 2.5em;
            color: #2c3e50;
            margin-bottom: 20px;
            line-height: 1.2;
        }

        /* Form Inputs and Buttons */
        label {
            font-size: 1.1em;
            margin-bottom: 5px;
            color: #34495e;
        }

        input, select {
            width: 95%;
            padding: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 1em;
            color: #34495e;
            background-color: #ecf0f1;
            transition: border-color 0.3s;
            box-sizing: border-box;
        }

        input:focus, select:focus {
            border-color: #3498db;
            outline: none;
        }

        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #2980b9;
        }

        /* Canvas (Graph) */
        canvas {
            width: 100%;
            height: 400px;
            margin-top: 30px;
            border-radius: 6px;
        }

        /* Result Box Styling */
        .results {
            margin-top: 20px;
            font-size: 1.2em;
            color: #2c3e50;
        }

        .result-box {
            background-color: #f1c40f;
            color: #2c3e50;
            padding: 10px;
            border-radius: 6px;
            margin: 15px 0;
            font-size: 1.4em;
        }

        /* Select Boxes Styling */
        .distribution-select {
            margin-top: 10px;
            padding: 12px;
            font-size: 1em;
            background-color: #ecf0f1;
            box-sizing: border-box;
        }

        /* Paragraph Styling */
        p {
            font-size: 1rem;
            margin-top: 1rem;
            color: #555;
        }

        /* Footer Styling */
        footer {
            background-color: #333;
            color: #fff;
            padding: 1rem;
            text-align: center;
            margin-top: 2rem;
            width: 100%;
        }

        footer p {
            font-size: 0.9rem;
            margin: 0;
        }
    </style>
</head>
<body>
    
    <div class="container">
        <h1>Lebesgue vs Riemann Integration Simulation</h1>
        <label for="intervalStart">Start of Interval (a):</label>
        <input type="number" id="intervalStart" value="0" />
        
        <label for="intervalEnd">End of Interval (b):</label>
        <input type="number" id="intervalEnd" value="1" />
        
        <label for="numPoints">Number of Points (n):</label>
        <input type="number" id="numPoints" value="1000" min="1" />
        
        <label for="function">Function (f(x)):</label>
        <select id="function">
            <option value="x^2">f(x) = x²</option>
            <option value="x^3">f(x) = x³</option>
            <option value="sin(x)">f(x) = sin(x)</option>
            <option value="exp(x)">f(x) = e^x</option>
        </select>

        <label for="distribution">Measure (Distribution) Type:</label>
        <select id="distribution" class="distribution-select">
            <option value="uniform">Uniform Distribution</option>
            <option value="normal">Normal Distribution</option>
        </select>

        <button id="computeButton">Compute Integrals</button>

        <div id="riemannResult" class="results"></div>
        <div id="lebesgueResult" class="results"></div>
        
        <canvas id="graphCanvas"></canvas>
    </div>

    <script>
        'use strict';

        // Funzione per analizzare la funzione selezionata dall'utente o una funzione personalizzata
        class Integration {
            static parseFunction(funcStr) {
                switch (funcStr) {
                    case "x^2":
                        return x => Math.pow(x, 2);
                    case "x^3":
                        return x => Math.pow(x, 3);
                    case "sin(x)":
                        return x => Math.sin(x);
                    case "exp(x)":
                        return x => Math.exp(x);
                    default:
                        return x => x;
                }
            }

            static computeRiemann(f, a, b, n) {
                const dx = (b - a) / n;
                let riemannSum = 0;
                for (let i = 0; i < n; i++) {
                    const midPoint = a + (i + 0.5) * dx;
                    riemannSum += f(midPoint);
                }
                return riemannSum * dx;
            }

            static computeLebesgueStieltjes(f, a, b, n, measure) {
                const dx = (b - a) / n;
                const xValues = Array.from({ length: n }, (_, i) => a + i * dx);
                const yValues = xValues.map(f);

                let lebSum = 0;
                for (let i = 0; i < n - 1; i++) {
                    let weight = 1;
                    if (measure === "uniform") {
                        weight = 1 / (b - a);
                    } else if (measure === "normal") {
                        const mean = (a + b) / 2;
                        const stdDev = (b - a) / 6;
                        const normalWeight = Math.exp(-0.5 * Math.pow((xValues[i] - mean) / stdDev, 2)) / (stdDev * Math.sqrt(2 * Math.PI));
                        weight = normalWeight;
                    }
                    lebSum += f(xValues[i]) * weight * (xValues[i + 1] - xValues[i]);
                }
                return lebSum;
            }

            static visualizeGraph(f, a, b, n, riemannIntegral, lebesgueStieltjesIntegral) {
                const canvas = document.getElementById('graphCanvas');
                const ctx = canvas.getContext('2d');
                const dx = (b - a) / n;
                const scaleX = canvas.width / (b - a);
                const scaleY = 100;

                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.beginPath();
                ctx.moveTo((a - a) * scaleX, canvas.height - f(a) * scaleY);

                for (let i = 0; i <= n; i++) {
                    const x = a + i * dx;
                    ctx.lineTo((x - a) * scaleX, canvas.height - f(x) * scaleY);
                }

                ctx.strokeStyle = '#1abc9c';
                ctx.stroke();

                ctx.fillStyle = 'rgba(26, 188, 156, 0.3)';
                for (let i = 0; i < n; i++) {
                    const midPoint = a + (i + 0.5) * dx;
                    const height = f(midPoint);
                    ctx.fillRect((midPoint - a) * scaleX, canvas.height - height * scaleY, dx * scaleX, height * scaleY);
                }

                ctx.fillStyle = '#2c3e50';
                ctx.fillText(`Riemann Integral: ${riemannIntegral.toFixed(5)}`, 10, canvas.height - 10);
                ctx.fillText(`Lebesgue-Stieltjes Integral: ${lebesgueStieltjesIntegral.toFixed(5)}`, 10, canvas.height - 30);
            }
        }

        document.getElementById('computeButton').addEventListener('click', () => {
            const a = parseFloat(document.getElementById('intervalStart').value);
            const b = parseFloat(document.getElementById('intervalEnd').value);
            const n = parseInt(document.getElementById('numPoints').value);
            const funcStr = document.getElementById('function').value;
            const measure = document.getElementById('distribution').value;

            const f = Integration.parseFunction(funcStr);

            const riemannIntegral = Integration.computeRiemann(f, a, b, n);
            const lebesgueStieltjesIntegral = Integration.computeLebesgueStieltjes(f, a, b, n, measure);

            document.getElementById('riemannResult').innerHTML = `<div class="result-box"><strong>Riemann Integral:</strong> ${riemannIntegral.toFixed(5)}</div>`;
            document.getElementById('lebesgueResult').innerHTML = `<div class="result-box"><strong>Lebesgue-Stieltjes Integral:</strong> ${lebesgueStieltjesIntegral.toFixed(5)}</div>`;

            Integration.visualizeGraph(f, a, b, n, riemannIntegral, lebesgueStieltjesIntegral);
        });
    </script>
</body>
</html>
