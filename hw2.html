<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Walk Simulator</title>
    <style>
        /* Stili per l'header e il layout */
        header {
            width: 100%;
            background-color: #333;
            color: #ffffff;
            text-align: center;
            padding: 0;
            margin: 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        main {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        main h2 {
            font-size: 2em;
            margin-bottom: 20px;
        }

        nav {
            background-color: #333;
            padding: 10px;
        }

        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        nav ul li {
            display: inline;
        }

        nav a {
            display: inline-block;
            color: white;
            background-color: #007bff;
            padding: 10px 15px;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        nav a:hover {
            background-color: #0056b3;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            padding: 0;
        }

        #controls {
            margin-bottom: 20px;
        }

        button {
            background-color: #007BFF;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #0056b3;
        }

        input[type="number"] {
            width: 50px;
            padding: 5px;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        .desc-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 100%;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            width: 100%;
        }

        .concept-panel {
            border: 1px solid #ccc;
            padding: 15px;
            width: calc(33.33% - 20px);
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
        }

        .concept-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        @media (max-width: 768px) {
            .concept-panel {
                width: calc(50% - 20px);
            }
        }

        @media (max-width: 480px) {
            .concept-panel {
                width: 100%;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
        </ul>
    </nav>
    <h2>Random Walk Simulator</h2>

    <div id="controls">
        <label>Steps: <input type="number" id="steps" value="100" /></label>
        <label>Paths: <input type="number" id="paths" value="5" /></label>
        <label>Time Step: <input type="number" step="0.01" id="time-step" value="0.1" /></label>
        <label>Jump Probability: <input type="number" step="0.1" id="jump-prob" value="0.1" /></label>
        <button id="run-simulation">Run Simulation</button>
    </div>

    <div class="chart-container">
        <canvas id="walkChart"></canvas>
    </div>
    <div>
        <p>
            <br>
        </p>
    </div>
    <div class="chart-container">
        <canvas id="meanChart"></canvas>
    </div>
    <div>
        <p>
            <br>
        </p>
    </div>
    <div class="chart-container">
        <canvas id="varianceChart"></canvas>
    </div>
    <div>
        <p>
            <br>
        </p>
    </div>
    <div class="chart-container">
        <canvas id="distributionChart"></canvas>
    </div>
    <div>
        <p>
            <br>
        </p>
    </div>
    <h2>Statistic Notions</h2>

    <div class="desc-content">
        <div class="concept-panel">
            <div class="concept-title">Standard Deviation</div>
            <p>Standard deviation is a measure of how spread out the values in a dataset are. It indicates the typical distance between the individual values and the mean of the dataset.</p>
            <p>A small standard deviation means that the data points tend to be close to the mean, while a large standard deviation indicates that the data points are spread out over a larger range of values.</p>
            <p>Standard deviation is widely used in statistics to understand the variability or dispersion in data.</p>
        </div>
    
        <div class="concept-panel">
            <div class="concept-title">Variance</div>
            <p>Variance measures how far a set of numbers are spread out from their mean. It is calculated as the average of the squared differences from the mean.</p>
            <p>Variance helps in understanding the distribution of data points and is the square of the standard deviation.</p>
            <p>Like standard deviation, higher variance indicates greater dispersion, while lower variance indicates that data points are closer to the mean.</p>
        </div>
    
        <div class="concept-panel">
            <div class="concept-title">Normal Distribution</div>
            <p>Normal distribution, also known as Gaussian distribution, is a probability distribution where most of the values cluster around the central peak. The distribution is symmetric, meaning values are equally likely to be above or below the mean.</p>
            <p>The mean, median, and mode of a normal distribution are all equal, and the spread of values is described by the standard deviation.</p>
            <p>This distribution is important in statistics because many real-world phenomena tend to follow a normal distribution.</p>
        </div>
    </div>

    <div class="desc-content">
        <div class="concept-panel">
            <div class="concept-title">Random Walk</div>
            <p>A random walk is a mathematical concept that describes a path consisting of a series of random steps. It is used to model various phenomena in physics, economics, biology, and other fields.</p>
            <p>In a random walk, each step is determined randomly, and the position of the walker at each step depends on both the random step and the previous position. The walk can occur in one dimension, two dimensions, or more, and may involve fixed-size steps or variable steps.</p>
            <p>This model is widely used to describe unpredictable processes, such as stock market fluctuations, diffusion of particles, or genetic drift in populations. In statistics, it is also important in the study of stochastic processes.</p>
        </div>
    
        <div class="concept-panel">
            <div class="concept-title">Mean</div>
            <p>The mean (or average) is a central statistical measure that represents the typical or central value of a dataset. It is computed by summing all the values in a dataset and dividing the sum by the total number of values. The mean provides insight into the overall tendency or center of the data:</p>
            <p>If the values are close together, the mean gives a good indication of a central point.</p>
            <p>However, the mean can be affected by outliers, as extreme values can skew the mean in one direction or another.</p>
        </div>
    
        <div class="concept-panel">
            <div class="concept-title">Central Limit Theorem</div>
            <p>The Central Limit Theorem states that the distribution of the sample mean of a large number of independent, identically distributed variables will tend to follow a normal distribution, regardless of the original distribution of the variables.</p>
            <p>This theorem is foundational in statistics and justifies using normal distribution in many types of analysis, especially when working with large datasets.</p>
            <p>The Central Limit Theorem allows for simplifying the analysis of complex datasets by assuming that the sample mean will be approximately normally distributed.</p>
        </div>
    </div>

    <script>
        let walkChart, meanChart, varianceChart, distributionChart;

        const getGaussianRandom = (mean = 0, stddev = 1) => {
            let u = Math.random();
            let v = Math.random();
            return mean + stddev * Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
        };

        const generateRandomJump = (prob) => Math.random() < prob ? (Math.random() < 0.5 ? -1 : 1) : 0;

        const runSimulation = (steps, dt, paths, jumpProb) => {
            let pathsData = [];
            let meanValues = Array(steps).fill(0);
            let varianceValues = Array(steps).fill(0);
            let finalPositions = [];

            for (let p = 0; p < paths; p++) {
                let path = [];
                let position = 0;

                for (let i = 0; i < steps; i++) {
                    let step = getGaussianRandom(0, Math.sqrt(dt));
                    let jump = generateRandomJump(jumpProb);
                    position += step + jump;
                    path.push(position);

                    let delta = position - meanValues[i];
                    meanValues[i] += delta / (p + 1);
                    varianceValues[i] += delta * (position - meanValues[i]);
                }

                pathsData.push(path);
                finalPositions.push(position); // Salva la posizione finale
            }

            varianceValues = varianceValues.map((v, i) => v / paths);

            return { pathsData, meanValues, varianceValues, finalPositions };
        };

        const calculateFrequencyDistribution = (positions) => {
            let frequencyMap = {};
            positions.forEach(pos => {
                let roundedPos = Math.round(pos);
                frequencyMap[roundedPos] = (frequencyMap[roundedPos] || 0) + 1;
            });

            let absoluteFrequencies = [];
            let relativeFrequencies = [];

            for (let position in frequencyMap) {
                absoluteFrequencies.push({ position: position, count: frequencyMap[position] });
                relativeFrequencies.push({ position: position, count: frequencyMap[position] / positions.length });
            }

            return { absoluteFrequencies, relativeFrequencies };
        };

        const plotCharts = (paths, meanValues, varianceValues, steps, finalPositions) => {
            const labels = Array.from({ length: steps }, (_, i) => i + 1);

            if (walkChart) walkChart.destroy();
            if (meanChart) meanChart.destroy();
            if (varianceChart) varianceChart.destroy();
            if (distributionChart) distributionChart.destroy();

            const walkDatasets = paths.map((path, i) => ({
                label: `Path ${i + 1}`,
                data: path,
                borderColor: getRandomColor(),
                fill: false,
                stepped: true
            }));

            walkChart = new Chart(document.getElementById('walkChart'), {
                type: 'line',
                data: { labels, datasets: walkDatasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { x: { title: { display: true, text: 'Step' } }, y: { title: { display: true, text: 'Position' } } },
                    plugins: { legend: { display: true, position: 'bottom' } }
                }
            });

            meanChart = new Chart(document.getElementById('meanChart'), {
                type: 'line',
                data: {
                    labels,
                    datasets: [{ label: 'Mean', data: meanValues, borderColor: 'red', fill: false }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { x: { title: { display: true, text: 'Step' } }, y: { title: { display: true, text: 'Mean Value' } } }
                }
            });

            varianceChart = new Chart(document.getElementById('varianceChart'), {
                type: 'line',
                data: {
                    labels,
                    datasets: [{ label: 'Variance', data: varianceValues, borderColor: 'blue', fill: false }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { x: { title: { display: true, text: 'Step' } }, y: { title: { display: true, text: 'Variance Value' } } }
                }
            });

            const { absoluteFrequencies, relativeFrequencies } = calculateFrequencyDistribution(finalPositions);

            distributionChart = new Chart(document.getElementById('distributionChart'), {
                type: 'bar',
                data: {
                    labels: absoluteFrequencies.map(f => f.position),
                    datasets: [
                        {
                            label: 'Absolute Frequency',
                            data: absoluteFrequencies.map(f => f.count),
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Relative Frequency',
                            data: relativeFrequencies.map(f => f.count),
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { x: { title: { display: true, text: 'Position' } }, y: { title: { display: true, text: 'Frequency' } } },
                    plugins: { legend: { display: true, position: 'bottom' } }
                }
            });
        };

        const getRandomColor = () => {
            const r = Math.floor(Math.random() * 255);
            const g = Math.floor(Math.random() * 255);
            const b = Math.floor(Math.random() * 255);
            return `rgb(${r},${g},${b})`;
        };

        document.getElementById('run-simulation').addEventListener('click', () => {
            const steps = parseInt(document.getElementById('steps').value);
            const paths = parseInt(document.getElementById('paths').value);
            const dt = parseFloat(document.getElementById('time-step').value);
            const jumpProb = parseFloat(document.getElementById('jump-prob').value);

            const { pathsData, meanValues, varianceValues, finalPositions } = runSimulation(steps, dt, paths, jumpProb);
            plotCharts(pathsData, meanValues, varianceValues, steps, finalPositions);
        });
    </script>
</body>
</html>
