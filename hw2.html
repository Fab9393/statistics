
<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulazione di Attacco</title>
    <link rel="stylesheet" href="styles.css"> <!-- Link al file CSS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Stili per l'header e il layout */
        header {
            width: 100%;
            background-color: #333;
            color: #ffffff;
            text-align: center;
            padding: 0;
            margin: 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        main {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        main h2 {
            font-size: 2em;
            margin-bottom: 20px;
        }

        nav {
            background-color: #333;
            padding: 10px;
        }

        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        nav ul li {
            display: inline;
        }

        nav a {
            display: inline-block;
            color: white;
            background-color: #007bff;
            padding: 10px 15px;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        nav a:hover {
            background-color: #0056b3;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            padding: 0;
        }

        #controls {
            margin-bottom: 20px;
        }

        button {
            background-color: #007BFF;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #0056b3;
        }

        input[type="number"] {
            width: 50px;
            padding: 5px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
            margin-bottom: 20px;
        }

        .desc-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 100%;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            width: 100%;
        }

        .concept-panel {
            border: 1px solid #ccc;
            padding: 15px;
            width: calc(33.33% - 20px);
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
        }

        .concept-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        @media (max-width: 768px) {
            .concept-panel {
                width: calc(50% - 20px);
            }
        }

        @media (max-width: 480px) {
            .concept-panel {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
        </ul>
    </nav>

    <div class="container">
        <h1>Welford Algorithm</h1>
        <label for="servers">Servers:</label>
        <input type="number" id="servers" value="10" min="1"><br><br>

        <label for="attackers">Hackers:</label>
        <input type="number" id="attackers" value="5" min="1"><br><br>

        <label for="probability">Probability (0-1):</label>
        <input type="number" step="0.01" id="probability" value="0.5" min="0 max="1"><br><br>

        <label for="time">Time:</label>
        <input type="number" id="time" value="100" min="1"><br><br>

        <button id="simulateButton">Esegui Simulazione</button>
    </div>
    <div id="chartContainer">
        <div id="canvasContainer">
            <canvas id="graficoTraiettoriaAggressori"></canvas>
        </div>
        <div id="canvasContainer">
            <canvas id="graficoDistribuzioneAggressori"></canvas>
        </div>

    <div class="container">
        <h2>Statistiche</h2>
        <p>Media: <span id="mean">0</span></p>
        <p>Deviazione Standard: <span id="stdDev">0</span></p>
        <p>Moda: <span id="mode">0</span></p>
    </div>

    <footer>
        <p>&copy;2024 Fabio Figara - Statistics Blog - Homework 1</p>
    </footer>
    
    <script>
        let grafici = {};

        // Funzione per eseguire la simulazione
        const avviaSimulazione = () => {
            const numeroServer = parseInt(document.getElementById('servers').value);
            const numeroAggressori = parseInt(document.getElementById('attackers').value);
            const probabilitaAttacco = parseFloat(document.getElementById('probability').value);
            const tempo = parseInt(document.getElementById('time').value);

            const traiettorieTotali = ottieniTraiettorie(numeroAggressori, tempo, probabilitaAttacco);

            // Calcola la distribuzione finale degli aggressori
            const distribuzioneFinale = calcolaDistribuzione(traiettorieTotali);

            // Calcola l'intervallo per i grafici
            const intervalloGrafico = calcolaIntervallo(traiettorieTotali);

            // Aggiorna i grafici
            graficoLineare(traiettorieTotali, tempo, intervalloGrafico, 'graficoTraiettoriaAggressori');
            graficoDistribuzione(distribuzioneFinale, numeroServer, intervalloGrafico, 'graficoDistribuzioneAggressori');

            // Calcola e visualizza le statistiche
            mostraStatistiche(distribuzioneFinale);
        };

        // Funzione per generare tutte le traiettorie degli aggressori
        const ottieniTraiettorie = (numeroAggressori, tempo, probabilitaAttacco) => {
            const traiettorie = [];
            for (let i = 0; i < numeroAggressori; i++) {
                traiettorie.push(generaTraiettoria(tempo, probabilitaAttacco));
            }
            return traiettorie;
        };

        // Funzione per generare una traiettoria di attacco
        const generaTraiettoria = (passi, probabilita) => {
            let posizioneAttuale = 0;
            const traiettoria = [];
            for (let i = 0; i < passi; i++) {
                posizioneAttuale += esitoAttacco(probabilita);
                traiettoria.push(posizioneAttuale);
            }
            return traiettoria;
        };

        // Funzione per determinare l'esito di un attacco
        const esitoAttacco = (probabilita) => Math.random() < probabilita ? 1 : -1;

        // Funzione per calcolare la distribuzione finale
        const calcolaDistribuzione = (trajectories) => {
            return trajectories.map(t => t[t.length - 1])
                .reduce((acc, posizione) => {
                    acc[posizione] = (acc[posizione] || 0) + 1;
                    return acc;
                }, {});
        };

        // Funzione per calcolare l'intervallo grafico
        const calcolaIntervallo = (trajectories) => {
            return Math.max(...trajectories.flat().map(Math.abs));
        };

        // Funzione per aggiornare il grafico a linee
        const graficoLineare = (dataLineari, numeroPassi, intervalloGrafico, graficoID) => {
        const ctx = document.getElementById(graficoID).getContext('2d');
        const etichette = Array.from({ length: numeroPassi + 1 }, (_, i) => `${i}`);
        const dataset = dataLineari.map((dati, indice) => ({
            label: `Aggressore ${indice + 1}`,
            data: dati.map((valore, i) => ({ x: i, y: valore })),
            fill: false,
            borderColor: getRandomColor(), // Utilizza getRandomColor() qui
            borderWidth: 1,
            stepped: true,
            pointRadius: 0,
        }));

        if (grafici[graficoID]) {
            grafici[graficoID].destroy();
        }
        grafici[graficoID] = new Chart(ctx, {
            type: 'line',
            data: { labels: etichette, datasets: dataset },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        min: -intervalloGrafico,
                        max: intervalloGrafico,
                        display: false
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
    };

    // Funzione per aggiornare il grafico della distribuzione
    const graficoDistribuzione = (risultati, numeroServer, intervalloGrafico, graficoID) => {
        const ctx = document.getElementById(graficoID).getContext('2d');
        const etichette = Array.from({ length: intervalloGrafico * 2 + 2 }, (_, i) => ((-intervalloGrafico) + i).toString());

        if (grafici[graficoID]) {
            grafici[graficoID].destroy();
        }
        grafici[graficoID] = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: etichette,
                datasets: [{
                    label: 'Numero di Aggressori',
                    data: risultati,
                    backgroundColor: Array.from({ length: numeroServer }, () => getRandomColor()), // Utilizza getRandomColor() qui
                }]
            },
            options: {
                indexAxis: 'y',
                scales: {
                    x: { beginAtZero: true },
                    y: { reverse: true, display: false, beginAtZero: true }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
    };

        // Funzione per mostrare le statistiche
        const mostraStatistiche = (distribuzione) => {
            const media = calcolaMedia(distribuzione);
            const deviazioneStandard = calcolaDeviazioneStandard(distribuzione);
            const moda = calcolaModa(distribuzione);

            document.getElementById('mean').textContent = media.toFixed(2);
            document.getElementById('stdDev').textContent = deviazioneStandard.toFixed(2);
            document.getElementById('mode').textContent = moda;
        };

        // Funzione per calcolare la media
        const calcolaMedia = (distribuzione) => {
            const totale = Object.keys(distribuzione).reduce((somma, chiave) => somma + (parseInt(chiave) * distribuzione[chiave]), 0);
            const conteggio = Object.values(distribuzione).reduce((somma, valore) => somma + valore, 0);
            return totale / conteggio;
        };

        // Funzione per calcolare la deviazione standard
        const calcolaDeviazioneStandard = (distribuzione) => {
            const media = calcolaMedia(distribuzione);
            const varianza = Object.keys(distribuzione).reduce((somma, chiave) => {
                const differenza = parseInt(chiave) - media;
                return somma + (differenza * differenza * distribuzione[chiave]);
            }, 0);
            const conteggio = Object.values(distribuzione).reduce((somma, valore) => somma + valore, 0);
            return Math.sqrt(varianza / conteggio);
        };

        // Funzione per calcolare la moda
        const calcolaModa = (distribuzione) => {
            const conteggioMax = Math.max(...Object.values(distribuzione));
            const modi = Object.keys(distribuzione).filter(chiave => distribuzione[chiave] === conteggioMax);
            return modi.join(', ');
        };

        // Funzione per generare colori casuali per ogni linea (hacker)
        function getRandomColor() {
            const letters = '0123456789ABCDEF'; 
            let color = '#'; 
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color; 
        }

        // Evento di click per avviare la simulazione
        document.getElementById('simulateButton').addEventListener('click', avviaSimulazione);
    </script>

</body>
</html>
