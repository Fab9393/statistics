<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulazione di Attacco</title>
    <style>
        .contenitore {
            width: 100%;
            display: flex;
            justify-content: center;
            background-color: #f0f4f8;
            padding: 40px;
            font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif;
        }

        .compito {
            min-height: 100vh;
            display: flex;
            align-items: start;
            flex-direction: column;
            width: 80%;
            max-width: 1200px;
            background-color: #ffffff;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-radius: 16px;
            padding: 60px;
            line-height: 1.6;
        }

        h1 {
            font-size: 3.5em;
            color: #2c3e50;
            margin-bottom: 40px;
            font-weight: 700;
        }

        h2, h3 {
            color: #34495e;
            margin-bottom: 25px;
            font-weight: 600;
        }

        p {
            font-size: 1.1em;
            color: #5d6d7e;
            margin-bottom: 25px;
            line-height: 1.8;
        }

        .gruppo-input {
            margin-bottom: 25px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        label {
            font-size: 1.1em;
            color: #34495e;
            font-weight: 500;
        }

        input[type='number'] {
            width: 120px;
            padding: 12px;
            border: 2px solid #dde4e9;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        input[type='number']:focus {
            outline: none;
            border-color: #3498db;
        }

        .bottone-esegui {
            display: flex;
            width: 100%;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-top: 30px;
        }

        .bottone-esegui {
            background-color: #3498db;
            color: #fff;
            padding: 14px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .bottone-esegui:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }

        .bottone-esegui-disabilitato {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }

        canvas {
            margin-top: 50px;
            max-width: 50%;
            margin-left: 8px;
        }

        .statistiche {
            width: 100%;
            color: #34495e;
            display: flex;
            flex-direction: row;
            justify-content: space-around;
            margin-top: 40px;
            background-color: #f8fafc;
            padding: 30px;
            border-radius: 12px;
        }

        .statistiche h2 {
            font-size: 2em;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .statistiche p {
            font-size: 1.2em;
            margin: 10px 0;
            color: #34495e;
        }

        pre {
            width: 100%;
            background-color: #f8fafc;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            max-height: 400px;
            margin-bottom: 30px;
        }

        code {
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.95em;
            color: #2c3e50;
        }

        .compito > * {
            max-width: 100%;
        }

        @media (max-width: 768px) {
            .compito {
                width: 95%;
                padding: 30px;
            }

            h1 {
                font-size: 2.5em;
            }

            .gruppo-input {
                flex-direction: column;
                align-items: flex-start;
            }

            input[type='number'] {
                width: 100%;
                margin-top: 10px;
            }
        }

        .contenitore-grafici {
            display: flex;
            width: 100%;
            height: 600px;
            margin-top: 50px;
            align-items: stretch;
        }

        #graficoTimesteps {
            flex: 2;
            margin-right: -20px;
        }

        #graficoIstogramma {
            flex: 1;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="contenitore">
            <div class="compito">
                <h1>Compito #2</h1>
                <h2>Teoria: Algoritmo di Welford</h2>
                <p>
                    L'algoritmo di Welford fornisce un metodo efficiente e numericamente stabile per calcolare la media e
                    la varianza in un singolo passaggio:
                </p>
                <pre><code>
// Per la media:
M₁ = x₁
per k = 2 fino a n:
    M_k = M_{k-1} + (x_k - M_{k-1}) / k

// Per la varianza:
S₁ = 0
per k = 2 fino a n:
    S_k = S_{k-1} + (x_k - M_{k-1})(x_k - M_k)
varianza = S_n / (n - 1)
                </code></pre>
                <h3>Perché usare l'algoritmo di Welford?</h3>
                <p>
                    1. Quando si lavora con grandi set di dati o valori ad alta precisione, il metodo naive per
                    calcolare la varianza (∑(x - μ)² / n) può portare a cancellazioni catastrofiche, specialmente quando
                    la varianza è piccola rispetto alla media. L'algoritmo di Welford minimizza questi errori di
                    arrotondamento.
                </p>
                <p>
                    2. Questo algoritmo calcola sia la media che la varianza in un singolo passaggio attraverso i dati,
                    il che è più efficiente rispetto agli algoritmi a due passaggi, specialmente per grandi set di
                    dati.
                </p>
                <p>
                    3. Consente aggiornamenti in tempo reale mentre arrivano nuovi punti dati, rendendolo adatto per
                    applicazioni in streaming o in tempo reale, dove i dati vengono elaborati man mano che arrivano
                    piuttosto che essere memorizzati e poi rielaborati tutti insieme.
                </p>
                <h2>Applicazione / Pratica</h2>
                <p>
                    Abbiamo n server con m attaccanti. L'hacker ha una probabilità p di penetrare ciascun server.
                    Supportiamo ora sia il modello di cammino casuale (-1 o +1) che il modello di Bernoulli (0 o 1),
                    così come le traiettorie di frequenza assoluta e relativa.
                </p>
                <h2>Spiegazione dettagliata: calcolo della deviazione standard</h2>
                <p>
                    La deviazione standard è una misura della quantità di variazione o dispersione in un insieme di
                    valori. Viene calcolata come la radice quadrata della varianza. L'algoritmo di Welford fornisce un
                    metodo efficiente e numericamente stabile per calcolare sia la media che la varianza in un
                    singolo passaggio attraverso i dati.
                </p>
                <div class="gruppo-input">
                    <label for="serverCount">Numero di server (n):</label>
                    <input type="number" id="serverCount" v-model.number="numeroServer" min="1" step="1" />
                </div>
                <div class="gruppo-input">
                    <label for="attackerCount">Numero di attaccanti (m):</label>
                    <input type="number" id="attackerCount" v-model.number="numeroAttaccanti" min="1" step="1" />
                </div>
                <div class="gruppo-input">
                    <label for="penetrationProb">Probabilità di penetrazione (p):</label>
                    <input type="number" id="penetrationProb" v-model.number="probPenetrazione" min="0" max="1" step="0.01" />
                </div>
                <div class="gruppo-input">
                    <label for="timesteps">Numero di passi temporali:</label>
                    <input type="number" id="timesteps" v-model.number="passiTemporali" min="1" step="1" />
                </div>
                <div class="bottone-esegui" :class="{'bottone-esegui-disabilitato': !abilitaBottone}" @click="eseguiSimulazione">
                    <span>Avvia Simulazione</span>
                </div>
                <div class="contenitore-grafici">
                    <canvas id="graficoTimesteps"></canvas>
                    <canvas id="graficoIstogramma"></canvas>
                </div>
                <div class="statistiche">
                    <div>
                        <h2>Statistiche</h2>
                        <p>Media: {{media}}</p>
                        <p>Deviazione standard: {{deviazioneStandard}}</p>
                    </div>
                    <div>
                        <h2>Deviazione standard della deviazione standard</h2>
                        <p>{{deviazioneStandardDeviazioneStandard}}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const app = new Vue({
            el: '#app',
            data: {
                numeroServer: 5,
                numeroAttaccanti: 3,
                probPenetrazione: 0.5,
                passiTemporali: 10,
                media: null,
                deviazioneStandard: null,
                deviazioneStandardDeviazioneStandard: null,
                risultati: [],
                abilitaBottone: true,
                colori: ['#3498db', '#e74c3c', '#2ecc71', '#f1c40f', '#9b59b6'],
                istogrammaData: [],
            },
            methods: {
                eseguiSimulazione() {
                    this.risultati = [];
                    this.istogrammaData = [];
                    let somma = 0;
                    let sommaQuadrati = 0;

                    for (let t = 0; t < this.passiTemporali; t++) {
                        const risultatoPasso = this.simulaAttacco();
                        this.risultati.push(risultatoPasso);
                        somma += risultatoPasso;
                        sommaQuadrati += risultatoPasso * risultatoPasso;

                        this.istogrammaData.push(risultatoPasso);
                    }

                    this.media = somma / this.passiTemporali;
                    this.deviazioneStandard = Math.sqrt((sommaQuadrati / this.passiTemporali) - (this.media * this.media));
                    this.deviazioneStandardDeviazioneStandard = this.calcolaDeviazioneStandard(this.risultati);

                    this.generaGraficoTimesteps();
                    this.generaGraficoIstogramma();
                },
                simulaAttacco() {
                    let attacchiRiusciti = 0;
                    for (let i = 0; i < this.numeroAttaccanti; i++) {
                        if (Math.random() < this.probPenetrazione) {
                            attacchiRiusciti++;
                        }
                    }
                    return attacchiRiusciti;
                },
                calcolaDeviazioneStandard(data) {
                    const media = data.reduce((acc, val) => acc + val, 0) / data.length;
                    const sommaQuadrati = data.reduce((acc, val) => acc + Math.pow(val - media, 2), 0);
                    return Math.sqrt(sommaQuadrati / (data.length - 1));
                },
                generaGraficoTimesteps() {
                    const ctx = document.getElementById('graficoTimesteps').getContext('2d');
                    const grafico = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: Array.from({ length: this.passiTemporali }, (_, i) => i + 1),
                            datasets: [{
                                label: 'Attacchi Riusciti',
                                data: this.risultati,
                                borderColor: this.colori[0],
                                backgroundColor: this.colori[0],
                                fill: false,
                                borderWidth: 2,
                            }],
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true,
                                },
                            },
                        },
                    });
                },
                generaGraficoIstogramma() {
                    const ctx = document.getElementById('graficoIstogramma').getContext('2d');
                    const grafico = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: Array.from({ length: this.passiTemporali }, (_, i) => `T${i + 1}`),
                            datasets: [{
                                label: 'Frequenza Attacchi Riusciti',
                                data: this.istogrammaData,
                                backgroundColor: this.colori[1],
                            }],
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true,
                                },
                            },
                        },
                    });
                },
            },
        });
    </script>
</body>
</html>
