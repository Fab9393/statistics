<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Walk Simulation</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
    font-family: Arial, sans-serif;
    background-color: #e7f0f7;
    margin: 0;
    padding: 20px;
    }

    .main-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    h1 {
        text-align: center;
        color: #333;
    }

    .input-section {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        margin-bottom: 20px;
    }

    .input-item {
        margin: 10px 0;
        flex: 1 1 45%;
    }

    label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }

    input[type='number'], select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    button {
        width: 100%;
        padding: 15px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
    }

    button:hover {
        background-color: #0056b3;
    }

    .results {
        display: flex;
        justify-content: space-between;
        margin: 20px 0;
    }

    .stats {
        width: 45%;
        padding: 15px;
        background: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 5px;
    }

    .chart-container {
        display: flex;
        justify-content: space-between;
        height: 400px;
    }

    canvas {
        flex: 1;
        margin: 0 10px;
    }

    </style>

</head>
<body>
    <div class="main-container">
        <h1>Random Walk Simulation</h1>
        <div class="input-section">
            <div class="input-item">
                <label for="numServers">Servers (n):</label>
                <input type="number" id="numServers" min="1" value="25">
            </div>
            <div class="input-item">
                <label for="numAttackers">Attackers (m):</label>
                <input type="number" id="numAttackers" min="1" value="50">
            </div>
            <div class="input-item">
                <label for="penetrationProb">Penetration Probability (p):</label>
                <input type="number" id="penetrationProb" min="0" max="1" step="0.01" value="0.5">
            </div>
            <div class="input-item">
                <label for="midIndex">Mid-point Index:</label>
                <input type="number" id="midIndex" min="0" value="12">
            </div>
            <div class="input-item">
                <label for="simulationChoice">Simulation Type:</label>
                <select id="simulationChoice">
                    <option value="randomWalk">Random Walk</option>
                    <option value="bernoulli">Bernoulli</option>
                </select>
            </div>
            <div class="input-item">
                <label for="freqChoice">Frequency Type:</label>
                <select id="freqChoice">
                    <option value="absolute">Absolute</option>
                    <option value="relative">Relative</option>
                </select>
            </div>
        </div>
        <button id="startSimulation">Start Simulation</button>

        <div class="results">
            <div class="stats">
                <h3>Statistics at Mid-point</h3>
                <p id="midMean">Mean: 0</p>
                <p id="midStdDev">Std Dev: 0</p>
                <p id="midMode">Mode: 0</p>
            </div>
            <div class="stats">
                <h3>Final Statistics</h3>
                <p id="finalMean">Mean: 0</p>
                <p id="finalStdDev">Std Dev: 0</p>
                <p id="finalMode">Mode: 0</p>
            </div>
        </div>

        <div class="chart-container">
            <canvas id="timestepChart"></canvas>
            <canvas id="histogramChart"></canvas>
        </div>
    </div>

    <script>
        document.getElementById('startSimulation').addEventListener('click', function() {
        const n = parseInt(document.getElementById('numServers').value);
        const m = parseInt(document.getElementById('numAttackers').value);
        const p = parseFloat(document.getElementById('penetrationProb').value);
        const midIndex = parseInt(document.getElementById('midIndex').value);
        const simulationType = document.getElementById('simulationChoice').value;
        const freqType = document.getElementById('freqChoice').value;

        let steps = [Array(m).fill(0)];
        
        // Perform the simulation
        for (let i = 1; i <= n; i++) {
            steps.push(steps[i - 1].map(value => {
                return simulationType === 'randomWalk' ? (Math.random() < p ? value + 1 : value - 1) : (Math.random() < p ? value + 1 : value);
            }));
        }

        // Apply frequency type
        if (freqType === 'relative') {
            steps = steps.map(step => step.map(value => value / n));
        }

        updateCharts(steps, midIndex);
        displayStatistics(steps, n, midIndex);
        });

        function updateCharts(steps, midIndex) {
            const timestepData = steps.map((step, index) => ({ x: index, y: step[midIndex] }));

            const timestepChartCtx = document.getElementById('timestepChart').getContext('2d');
            new Chart(timestepChartCtx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'Mid-point Values',
                        data: timestepData,
                        borderColor: 'rgba(0, 123, 255, 1)',
                        fill: false,
                    }]
                },
                options: {
                    scales: {
                        x: { title: { display: true, text: 'Timestep' } },
                        y: { title: { display: true, text: 'Value' } },
                    }
                }
            });

            const finalValues = steps[steps.length - 1];
            const frequencyData = {};
            finalValues.forEach(value => {
                frequencyData[value] = (frequencyData[value] || 0) + 1;
            });

            const labels = Object.keys(frequencyData);
            const values = Object.values(frequencyData);

            const histogramChartCtx = document.getElementById('histogramChart').getContext('2d');
            new Chart(histogramChartCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Frequency',
                        data: values,
                        backgroundColor: 'rgba(0, 123, 255, 0.6)',
                    }]
                },
                options: {
                    scales: {
                        x: { title: { display: true, text: 'Value' } },
                        y: { title: { display: true, text: 'Frequency' } },
                    }
                }
            });
        }

        function displayStatistics(steps, n, midIndex) {
            const finalValues = steps[n];
            const midValues = steps[midIndex];

            document.getElementById('midMean').innerText = `Mean: ${calculateMean(midValues).toFixed(2)}`;
            document.getElementById('midStdDev').innerText = `Std Dev: ${calculateStdDev(midValues).toFixed(2)}`;
            document.getElementById('midMode').innerText = `Mode: ${calculateMode(midValues).join(', ')}`;

            document.getElementById('finalMean').innerText = `Mean: ${calculateMean(finalValues).toFixed(2)}`;
            document.getElementById('finalStdDev').innerText = `Std Dev: ${calculateStdDev(finalValues).toFixed(2)}`;
            document.getElementById('finalMode').innerText = `Mode: ${calculateMode(finalValues).join(', ')}`;
        }

        function calculateMean(data) {
            const sum = data.reduce((acc, val) => acc + val, 0);
            return sum / data.length;
        }

        function calculateStdDev(data) {
            const mean = calculateMean(data);
            const variance = data.map(value => Math.pow(value - mean, 2)).reduce((acc, val) => acc + val, 0) / data.length;
            return Math.sqrt(variance);
        }

        function calculateMode(data) {
            const frequency = {};
            data.forEach(value => {
                frequency[value] = (frequency[value] || 0) + 1;
            });

            const maxCount = Math.max(...Object.values(frequency));
            return Object.keys(frequency).filter(key => frequency[key] === maxCount);
        }

    </script>
</body>
</html>
