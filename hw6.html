<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Distribuzione e Simulazione con Media e Varianza</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
                /* styles.css */

                * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            background-color: #f4f4f9;
            color: #333;
            line-height: 1.6;
        }

        header {
            background-color: #007bff;
            color: #fff;
            padding: 1rem;
            text-align: center;
        }

        header h1 {
            font-size: 2rem;
        }

        nav {
            background-color: #333;
            padding: 10px;
        }

        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        nav ul li {
            display: inline;
        }

        nav a {
            display: inline-block;
            color: white;
            background-color: #007bff;
            padding: 10px 15px;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        nav a:hover {
            background-color: #0056b3;
        }

        main {
            width: 90%;
            max-width: 1200px;
            margin: 2rem auto;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        section {
            background-color: #fff;
            padding: 1.5rem;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        section h2 {
            font-size: 1.75rem;
            margin-bottom: 1rem;
            color: #333;
        }

        section h3 {
            font-size: 1.5rem;
            margin-top: 1rem;
            color: #444;
        }

        section p,
        section pre {
            margin: 1rem 0;
            font-size: 1rem;
        }

        #controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1rem;
        }

        #controls label {
            font-weight: bold;
            color: #333;
        }

        #controls input,
        #controls button {
            padding: 0.5rem;
            font-size: 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        #controls button {
            background-color: #007bff;
            color: #fff;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #controls button:hover {
            background-color: #0056b3;
        }

        canvas {
            max-width: 100%;
            margin-top: 1rem;
        }

        #chartContainer {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            justify-content: space-around;
        }

        #emChart,
        #trajectoryChart,
        #distributionChart {
            width: 100%;
            max-width: 500px;
        }

        #regressionOutput {
            margin-top: 1rem;
            font-size: 1.1rem;
            color: #007bff;
        }

        footer {
            background-color: #333;
            color: #fff;
            padding: 1rem;
            text-align: center;
            margin-top: 2rem;
        }

        footer p {
            font-size: 0.9rem;
        }

        /* Style for the entire section */
        #code {
            background-color: #f7f7f7; /* Light grey background for the code section */
            padding: 20px; /* Add padding around the content */
            border-radius: 8px; /* Rounded corners */
            margin: 20px 0; /* Add space above and below */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Soft shadow for depth */
        }

        /* Heading Styles */
        #code h3 {
            font-size: 1.5em;
            color: #333; /* Dark text for the main heading */
            margin-bottom: 10px; /* Space below the main heading */
        }

        #code h4 {
            font-size: 1.2em;
            color: #555; /* Slightly lighter color for subheadings */
            margin-top: 20px; /* Space before each subheading */
        }

        /* Paragraph and description text */
        #code p {
            font-size: 1em;
            color: #444; /* Dark grey text */
            line-height: 1.6; /* Space out the lines for readability */
            margin-bottom: 10px; /* Space between paragraphs */
        }

        /* Strong emphasis for certain words */
        #code strong {
            font-weight: bold;
            color: #2c3e50; /* Darker color for emphasis */
        }

        /* Emphasis for inline code or variables */
        #code em {
            font-style: italic;
            color: #2980b9; /* Blue color for inline code */
        }

        /* List styles for functions description */
        #code ul {
            list-style-type: none; /* Remove default list style */
            margin-left: 0; /* No indentation */
            padding-left: 20px; /* Indentation for the list */
        }

        #code li {
            font-size: 1em;
            color: #333; /* Standard color for list items */
            margin-bottom: 8px; /* Space between list items */
        }

        /* Style for the <code> block inside <pre> */
        pre {
            background-color: #2d2d2d; /* Dark background for code blocks */
            color: #f8f8f2; /* Light text for code */
            padding: 15px; /* Padding inside the code block */
            border-radius: 5px; /* Rounded corners for the code block */
            overflow-x: auto; /* Horizontal scroll for long lines */
            font-family: 'Courier New', monospace; /* Monospaced font for code */
            font-size: 1em;
            line-height: 1.4; /* Line height for readability */
            white-space: pre-wrap; /* Wrap long lines */
        }

        pre code {
            display: block; /* Ensure code is displayed as block */
            word-wrap: break-word; /* Wrap long words */
        }

        /* Styling for the <code> tag for inline code */
        code {
            background-color: #f4f4f4; /* Light background for inline code */
            color: #c0392b; /* Red color for inline code */
            padding: 2px 5px; /* Padding inside inline code */
            border-radius: 4px; /* Rounded corners for inline code */
            font-family: 'Courier New', monospace;
        }

        /* Optional code block hover effect */
        pre:hover {
            background-color: #333; /* Darken background when hovering */
            transition: background-color 0.3s ease; /* Smooth transition for hover effect */
        }

        /* Styling for the entire section of the code block */
        #code > p {
            margin-bottom: 20px; /* Extra space after text descriptions */
        }
    </style>
</head>
<body>
    <header>
        <h1>Simulazione Distribuzione con Media e Varianza</h1>
    </header>

    <main>
        <!-- Sezione per generare campioni casuali e visualizzare grafici -->
        <section id="sample-generation">
            <h2>Generazione Campioni Casuali</h2>
            <label for="sampleSize">Numero di Campioni:</label>
            <input type="number" id="sampleSize" value="100" min="1">
            <button id="generateBtn">Genera Campioni</button>

            <div id="chartContainer">
                <canvas id="distributionChart"></canvas>
            </div>
        </section>
    </main>

    <section id="sample-generation">
        <div id="chartContainer">
            <canvas id="meanChart"></canvas>
            <canvas id="varianceChart"></canvas>
        </div>
    </section>

    <section id="code-fragments">
        <h3>Code Snippets</h3>
        <p>This section provides JavaScript functions for generating random samples and calculating progressive mean and variance.</p>

        <h4>Sample Generation Function</h4>
        <pre><code>function generateRandomSample(sampleCount) {
        const samples = [];
        for (let i = 0; i < sampleCount; i++) {
            const randomNum = Math.random();
            let sampleValue;
            for (let j = 0; j < cumulativeDistribution.length; j++) {
                if (randomNum < cumulativeDistribution[j]) {
                    sampleValue = distributionValues[j];
                    break;
                }
            }
            samples.push(sampleValue);
        }
        return samples;
        }</code></pre>

                <h4>Mean and Variance Calculation Function</h4>
                <pre><code>function calculateMeanVariance(data) {
        let n = 0, mean = 0, sumM2 = 0;
        const meanProgressive = [], varianceProgressive = [];

        data.forEach(value => {
            n++;
            const delta = value - mean;
            mean += delta / n;
            const delta2 = value - mean;
            sumM2 += delta * delta2;
            meanProgressive.push(mean);
            varianceProgressive.push(sumM2 / n);
        });

        return { meanProgressive, varianceProgressive };
        }</code></pre>
    </section>

    <footer>
        <p>&copy;2024 Distribuzione e Simulazione</p>
    </footer>

    <script>
        // Definire i valori e le probabilità
        const valoriDistribuzione = [1, 2, 3, 4, 5];
        const probabilitaTeoriche = [0.1, 0.2, 0.4, 0.2, 0.1];

        // Calcolo della funzione di distribuzione cumulativa (CDF)
        const distribuzioneCumulativa = [];
        probabilitaTeoriche.reduce((accumulatore, valoreCorrente, indice) => {
            distribuzioneCumulativa[indice] = accumulatore + valoreCorrente;
            return distribuzioneCumulativa[indice];
        }, 0);

        // Funzione per generare campioni casuali
        function generaCampioneCasuale(numeroCampioni) {
            const campioni = [];
            for (let i = 0; i < numeroCampioni; i++) {
                const numeroCasuale = Math.random();
                let valoreCampione;
                for (let j = 0; j < distribuzioneCumulativa.length; j++) {
                    if (numeroCasuale < distribuzioneCumulativa[j]) {
                        valoreCampione = valoriDistribuzione[j];
                        break;
                    }
                }
                campioni.push(valoreCampione);
            }
            return campioni;
        }

        // Algoritmo per media e varianza
        function calcolaMediaVarianza(dati) {
            let n = 0, media = 0, sommaM2 = 0;
            const medieProgressive = [], varianzeProgressive = [];

            dati.forEach(valore => {
                n++;
                const delta = valore - media;
                media += delta / n;
                const delta2 = valore - media;
                sommaM2 += delta * delta2;
                medieProgressive.push(media);
                varianzeProgressive.push(sommaM2 / n);
            });

            return { medieProgressive, varianzeProgressive };
        }

        // Variabili per i grafici
        let graficoDistribuzione, graficoMedia, graficoVarianza;

        // Funzione per aggiornare i grafici
        function aggiornaGrafici(numeroCampioni) {
            const campioni = generaCampioneCasuale(numeroCampioni);
            const probabilitaEmpiriche = valoriDistribuzione.map(valore => campioni.filter(c => c === valore).length / numeroCampioni);

            // Configurazioni grafiche comuni
            const opzioniGrafico = {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { title: { display: true, text: '' } },
                    y: { title: { display: true, text: '' }, beginAtZero: true }
                },
                plugins: {
                    legend: { position: 'top' }
                }
            };

            // Aggiorna il grafico di distribuzione
            if (graficoDistribuzione) graficoDistribuzione.destroy();
            const ctxDistribuzione = document.getElementById('distributionChart').getContext('2d');
            graficoDistribuzione = new Chart(ctxDistribuzione, {
                type: 'bar',
                data: {
                    labels: valoriDistribuzione,
                    datasets: [
                        {
                            label: 'Probabilità Teoriche',
                            data: probabilitaTeoriche,
                            backgroundColor: 'rgba(54, 162, 235, 0.7)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Probabilità Empiriche',
                            data: probabilitaEmpiriche,
                            backgroundColor: 'rgba(255, 99, 132, 0.7)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    ...opzioniGrafico,
                    scales: {
                        x: { title: { display: true, text: 'Valore' } },
                        y: { title: { display: true, text: 'Probabilità' }, beginAtZero: true, max: 0.5 }
                    }
                }
            });

            // Calcola media e varianza empiriche
            const { medieProgressive, varianzeProgressive } = calcolaMediaVarianza(campioni);

            // Crea le etichette per i campioni
            const etichetteCampioni = Array.from({ length: numeroCampioni }, (_, i) => i + 1);

            // Aggiorna il grafico della media
            if (graficoMedia) graficoMedia.destroy();
            const ctxMedia = document.getElementById('meanChart').getContext('2d');
            graficoMedia = new Chart(ctxMedia, {
                type: 'line',
                data: {
                    labels: etichetteCampioni,
                    datasets: [
                        {
                            label: 'Media Empirica',
                            data: medieProgressive,
                            borderColor: 'rgba(75, 192, 192, 1)',
                            fill: false,
                            pointRadius: 0
                        },
                        {
                            label: 'Media Teorica',
                            data: Array(numeroCampioni).fill(3),
                            borderColor: 'rgba(153, 102, 255, 1)',
                            borderDash: [5, 5],
                            fill: false,
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    ...opzioniGrafico,
                    scales: {
                        x: { title: { display: true, text: 'Numero di Campioni' } },
                        y: { title: { display: true, text: 'Media' } }
                    }
                }
            });

            // Aggiorna il grafico della varianza
            if (graficoVarianza) graficoVarianza.destroy();
            const ctxVarianza = document.getElementById('varianceChart').getContext('2d');
            graficoVarianza = new Chart(ctxVarianza, {
                type: 'line',
                data: {
                    labels: etichetteCampioni,
                    datasets: [
                        {
                            label: 'Varianza Empirica',
                            data: varianzeProgressive,
                            borderColor: 'rgba(255, 206, 86, 1)',
                            fill: false,
                            pointRadius: 0
                        },
                        {
                            label: 'Varianza Teorica',
                            data: Array(numeroCampioni).fill(1.2),
                            borderColor: 'rgba(201, 203, 207, 1)',
                            borderDash: [5, 5],
                            fill: false,
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    ...opzioniGrafico,
                    scales: {
                        x: { title: { display: true, text: 'Numero di Campioni' } },
                        y: { title: { display: true, text: 'Varianza' } }
                    }
                }
            });
        }

        // Evento per il bottone di generazione
        document.getElementById('generateBtn').addEventListener('click', () => {
            const numeroCampioni = parseInt(document.getElementById('sampleSize').value);
            if (numeroCampioni > 0) {
                aggiornaGrafici(numeroCampioni);
            } else {
                alert('Inserisci un numero valido di campioni.');
            }
        });

        // Rendering iniziale dei grafici con la dimensione di campionamento predefinita
        window.onload = () => {
            const numeroCampioniDefault = parseInt(document.getElementById('sampleSize').value);
            aggiornaGrafici(numeroCampioniDefault);
        };
    </script>
</body>
</html>
