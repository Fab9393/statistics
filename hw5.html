<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Custom Analysis Tool</title>
</head>
<body>
  <div class="container">
    <h2>Data Analysis Tool</h2>

    <!-- Margin Adjustment Script -->
    <script>
      function adjustLayout() {
        const mainElement = document.querySelector('.container');
        const viewportWidth = window.innerWidth;

        if (viewportWidth > 1400) {
          mainElement.style.marginLeft = "-20%";
        } else if (viewportWidth < 1000) {
          mainElement.style.marginLeft = "0px";
        } else if (viewportWidth > 1000 && viewportWidth < 1080) {
          mainElement.style.marginLeft = "-40px";
        } else {
          mainElement.style.marginLeft = `-${(viewportWidth - 1000) / 2}px`;
        }
      }

      adjustLayout();
      window.addEventListener('resize', adjustLayout);
    </script>

    <!-- Form for Chart Data Input -->
    <form id="dataForm">
      <label for="num1">Integer 1:</label>
      <input type="number" id="num1">
      
      <label for="num1_5">Intermediate Integer:</label>
      <input type="number" id="num1_5">
      
      <label for="num2">Integer 2:</label>
      <input type="number" id="num2">
      
      <label for="prob">Decimal Value:</label>
      <input type="number" id="prob" step="0.01">
      
      <label for="num3">Integer 3:</label>
      <input type="number" id="num3">
      
      <fieldset>
        <legend>Select Chart Type</legend>
        <label><input type="radio" name="graphType" value="chartA" checked> Chart Type A</label>
        <label><input type="radio" name="graphType" value="chartB"> Chart Type B</label>
        <label><input type="radio" name="graphType" value="chartC"> Chart Type C</label>
        <label><input type="radio" name="graphType" value="chartD"> Chart Type D</label>
      </fieldset>
      
      <button type="submit">Generate Chart</button>
    </form>

    <!-- Form for Regression Simulation Data Input -->
    <div>
      <h3>Regression Simulation</h3>
      <form id="simulationForm">
        <label for="xValues">Enter X Values (comma-separated):</label>
        <input type="text" id="xValues" placeholder="e.g., 1, 2, 3, 4">

        <label for="yValues">Enter Y Values (comma-separated):</label>
        <input type="text" id="yValues" placeholder="e.g., 2, 4, 6, 8">

        <button type="button" onclick="displayRegressionResults()">Calculate Regression</button>
      </form>
    </div>

    <div id="outputDisplay"></div>

    <!-- Chart and Regression Scripts -->
    <script>
      let firstChart = null;
      let secondChart = null;
      let thirdChart = null;
      let fourthChart = null;

      document.getElementById('dataForm').addEventListener('submit', function(event) {
        event.preventDefault();
        const num1 = parseInt(document.getElementById('num1').value);
        const intermediate = parseInt(document.getElementById('num1_5').value);
        const num2 = parseInt(document.getElementById('num2').value);
        const decimal = parseFloat(document.getElementById('prob').value);
        const num3 = parseInt(document.getElementById('num3').value);
        const selectedGraph = document.querySelector('input[name="graphType"]:checked').value;

        switch (selectedGraph) {
          case 'chartA':
            drawChartA(num1, num2, decimal);
            break;
          case 'chartB':
            drawChartB(num1, num2, num3, decimal, event);
            break;
          case 'chartC':
            drawChartC(num1, intermediate, num2, decimal, event);
            break;
          case 'chartD':
            drawChartD(num1, intermediate, num2, decimal, event);
            break;
        }
      });

      function calculateLineParams(xData, yData) {
        const count = xData.length;

        const avgX = xData.reduce((acc, val) => acc + val, 0) / count;
        const avgY = yData.reduce((acc, val) => acc + val, 0) / count;

        let sumNum = 0;
        let sumDenom = 0;
        for (let i = 0; i < count; i++) {
          sumNum += (xData[i] - avgX) * (yData[i] - avgY);
          sumDenom += (xData[i] - avgX) ** 2;
        }

        const slope = sumNum / sumDenom;
        const intercept = avgY - slope * avgX;

        return { intercept, slope };
      }

      function calculateDeterminationCoefficient(xData, yData, intercept, slope) {
        const count = xData.length;
        const avgY = yData.reduce((acc, val) => acc + val, 0) / count;

        let totalSS = 0;
        let residualSS = 0;

        for (let i = 0; i < count; i++) {
          const predictedY = intercept + slope * xData[i];
          totalSS += (yData[i] - avgY) ** 2;
          residualSS += (yData[i] - predictedY) ** 2;
        }

        const rSquared = 1 - (residualSS / totalSS);
        return rSquared;
      }

      function displayRegressionResults() {
        const xDataInput = document.getElementById("xValues").value;
        const yDataInput = document.getElementById("yValues").value;

        const xData = xDataInput.split(",").map(Number);
        const yData = yDataInput.split(",").map(Number);

        if (xData.length !== yData.length || xData.some(isNaN) || yData.some(isNaN)) {
          document.getElementById("outputDisplay").innerHTML = "<p style='color: red;'>Error: Ensure valid, matching-length numeric inputs for X and Y.</p>";
          return;
        }

        const { intercept, slope } = calculateLineParams(xData, yData);
        const rSquared = calculateDeterminationCoefficient(xData, yData, intercept, slope);

        document.getElementById("outputDisplay").innerHTML = `
          <p><strong>Intercept:</strong> ${intercept.toFixed(2)}</p>
          <p><strong>Slope:</strong> ${slope.toFixed(2)}</p>
          <p><strong>R<sup>2</sup>:</strong> ${rSquared.toFixed(2)}</p>
        `;
      }
    </script>
  </div>
</body>
</html>
