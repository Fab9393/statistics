<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Walk Simulation - HW4</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* CSS for seamless chart alignment */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f9f9f9;
            color: #333;
        }

        h2, h3 {
            text-align: center;
        }

        .chart-container {
            display: flex;
            align-items: stretch; /* Ensures charts are aligned vertically */
            justify-content: center;
            margin-top: 30px;
        }

        .chart {
            width: 70%;
            height: 400px;
            margin: 0; /* Remove space around charts */
            padding-right: 0;
            border-right: 1px solid #ddd; /* Optional: adds a subtle divider between the charts */
        }

        .histogram {
            width: 30%;
            height: 400px;
            margin: 0; /* Remove space around charts */
            padding-left: 0;
        }

        p {
            max-width: 800px;
            margin: 20px auto;
            line-height: 1.6;
            text-align: justify;
        }


    </style>
</head>
<body>

<h2>Random Walk Simulation</h2>
<div class="chart-container">
    <canvas id="lineChart" class="chart"></canvas>
    <canvas id="histogramChart" class="histogram"></canvas>
</div>

<h3>Theory of Continuous Random Walk and Donsker’s Theorem</h3>
<p>
    This simulation illustrates a <strong>continuous random walk</strong>, a stochastic process where each “walker” moves either left or 
    right with equal probability at very small time intervals. Each step length is proportional to <em>sqrt(dt)</em>, where <em>dt</em> 
    represents the time interval, and each step is determined randomly. This model is widely used in physics, finance, and other fields 
    to describe random processes over time.
</p>
<p>
    According to <strong>Donsker’s Theorem</strong>, also known as the functional central limit theorem, as the number of steps in a random 
    walk increases to infinity, the process converges to a Brownian motion (or Wiener process). This allows us to approximate large, discrete 
    random walks as continuous processes, which is especially useful in modeling phenomena like diffusion.
</p>
<p>
    By plotting the mean distribution and final distribution of the walkers, we can observe how the values begin to resemble a normal 
    distribution, especially as the number of walkers and time steps increase. This characteristic is due to the central limit theorem, 
    where the distribution of independent random variables tends toward normality as the sample size increases.
</p>
<p>
    The final chart on the right represents the <strong>distribution of positions</strong> of all walkers at the end of the simulation, 
    illustrating how randomness accumulates over time. In line with Donsker’s Theorem, this distribution approximates a Gaussian (normal) 
    distribution, especially with a high number of steps and walkers.
</p>

<script>
    // Parameters for the random walk
    const numSteps = 1000;
    const numWalkers = 500;
    const dt = 0.1;
    const stepSize = Math.sqrt(dt);

    // Arrays to hold walker positions at each step and final positions
    const allPositions = Array.from({ length: numWalkers }, () => [0]);
    const finalPositions = [];

    // Simulate random walk
    for (let step = 1; step <= numSteps; step++) {
        allPositions.forEach((positions, i) => {
            const lastPosition = positions[positions.length - 1];
            const stepDirection = Math.random() < 0.5 ? -1 : 1;
            const newPosition = lastPosition + stepDirection * stepSize;
            positions.push(newPosition);
            if (step === numSteps) finalPositions.push(newPosition);
        });
    }

    // Prepare data for line chart
    const avgPositions = Array.from({ length: numSteps + 1 }, (_, i) =>
        allPositions.reduce((sum, positions) => sum + positions[i], 0) / numWalkers
    );

    const lineChartData = {
        labels: Array.from({ length: numSteps + 1 }, (_, i) => i),
        datasets: [{
            label: 'Average Position of Walkers',
            data: avgPositions,
            borderColor: 'blue',
            fill: false,
            borderWidth: 2,
            tension: 0.2
        }]
    };

    // Render line chart
    const lineChartCtx = document.getElementById('lineChart').getContext('2d');
    new Chart(lineChartCtx, {
        type: 'line',
        data: lineChartData,
        options: {
            scales: {
                x: { display: true, title: { display: true, text: 'Time Steps' } },
                y: { display: true, title: { display: true, text: 'Average Position' } }
            }
        }
    });

    // Prepare histogram data
    const bins = 20;
    const binWidth = (Math.max(...finalPositions) - Math.min(...finalPositions)) / bins;
    const histogramData = Array(bins).fill(0);
    finalPositions.forEach(pos => {
        const bin = Math.min(bins - 1, Math.floor((pos - Math.min(...finalPositions)) / binWidth));
        histogramData[bin]++;
    });

    const histogramLabels = Array.from({ length: bins }, (_, i) =>
        (Math.min(...finalPositions) + i * binWidth).toFixed(2)
    );

    // Render histogram
    const histogramChartCtx = document.getElementById('histogramChart').getContext('2d');
    new Chart(histogramChartCtx, {
        type: 'bar',
        data: {
            labels: histogramLabels,
            datasets: [{
                label: 'Position Distribution',
                data: histogramData,
                backgroundColor: 'rgba(75, 192, 192, 0.5)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 1
            }]
        },
        options: {
            indexAxis: 'y',
            scales: {
                x: {
                    display: true,
                    title: { display: true, text: 'Number of Walkers' },
                    position: 'top'
                },
                y: {
                    display: true,
                    title: { display: true, text: 'Position' }
                }
            },
            plugins: {
                legend: { display: false }
            }
        }
    });
</script>

</body>
</html>